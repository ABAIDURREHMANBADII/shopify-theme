<div class="container py-5" id="wishlist-container">
  <h2 class="wishlist-title text-center">Your Wishlist</h2>

  <div class="feature-grid"></div>

  <p class="empty-wishlist text-center" style="display:none;">
    Your wishlist is empty.
  </p>
</div>

<script>
document.addEventListener("DOMContentLoaded", function() {

  let wishlist = JSON.parse(localStorage.getItem("wishlist")) || [];
  const container = document.querySelector(".feature-grid");
  const emptyText = document.querySelector(".empty-wishlist");

  function renderWishlist() {
    container.innerHTML = '';
    if (wishlist.length === 0) {
      emptyText.style.display = "block";
      return;
    }
    emptyText.style.display = "none";

    wishlist.forEach(handle => {
      fetch(`/products/${handle}.js`)
        .then(res => res.json())
        .then(product => {

          const image = product.featured_image || "https://via.placeholder.com/300";
          const price = (product.price / 100).toFixed(2);
          const currency = (typeof Shopify !== 'undefined' && Shopify.currency && Shopify.currency.active) ? Shopify.currency.active : 'USD';
          const description = product.description ? product.description.substring(0, 100) + "" : "";

          const card = document.createElement("div");
          card.classList.add("feature-item");
          card.dataset.handle = product.handle;

          card.innerHTML = `
<div class="feature-image-wrapper">
  <a href="/products/${product.handle}">
    <img src="${image}" alt="${product.title}" />
  </a>
  <div class="feature-buttons">
    <button class="wishlist-btn active" data-product-id="${product.handle}">
      <i class="fa-solid fa-heart"></i>
    </button>
    <button class="remove-wishlist" data-id="${product.handle}">Ã—</button>
  </div>
</div>
<div class="feature-content">
  <div>
    <h3>${product.title}</h3>
    <p>${description}</p>
  </div>
  <div>
    <span class="feature-price">${price} ${currency}</span>
  </div>
</div>
          `;

          container.appendChild(card);
        })
        .catch(err => console.log(err));
    });
  }

  renderWishlist();

  // Listen for clicks (toggle heart or remove)
  document.addEventListener("click", function(e){
    const target = e.target;

    // Remove button
    if (target.classList.contains("remove-wishlist")) {
      const id = target.dataset.id;
      wishlist = wishlist.filter(item => item !== id);
      localStorage.setItem("wishlist", JSON.stringify(wishlist));
      target.closest(".feature-item").remove();
      if (wishlist.length === 0) emptyText.style.display = "block";
    }

    // Heart toggle
    if (target.closest(".wishlist-btn")) {
      const btn = target.closest(".wishlist-btn");
      const id = btn.dataset.productId;

      if (btn.classList.contains("active")) {
        btn.classList.remove("active");
        wishlist = wishlist.filter(item => item !== id);
        btn.querySelector("i").className = "fa-regular fa-heart";

        // Auto-remove from wishlist page if exists
        const card = container.querySelector(`.feature-item[data-handle="${id}"]`);
        if (card) {
          card.remove();
          if (wishlist.length === 0) emptyText.style.display = "block";
        }

      } else {
        btn.classList.add("active");
        wishlist.push(id);
        btn.querySelector("i").className = "fa-solid fa-heart";
      }

      localStorage.setItem("wishlist", JSON.stringify(wishlist));
    }
  });

});
</script>



{% stylesheet %}
  css_styles
  /* Container Grid */
.feature-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
  margin-top: 30px;
}

/* Card Styling */
.feature-item {
  border: 1px solid #eee;
  border-radius: 12px;
  overflow: hidden;
  transition: transform 0.3s, box-shadow 0.3s;
  background: #fff;
  display: flex;
  flex-direction: column;

}

.feature-item:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

/* Image Wrapper */
.feature-image-wrapper {
  position: relative;
}



/* Buttons Overlay */
.feature-buttons {
  position: absolute;
  top: 10px;
  right: 10px;
  display: flex;
  gap: 8px;
}

.feature-buttons button {
  background: rgba(255,255,255,0.9);
  border: none;
  border-radius: 50%;
  width: 35px;
  height: 35px;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  transition: background 0.2s;
}

.feature-buttons button:hover {
  background: #f0f0f0;
}

/* Content */
.feature-content {
  padding: 15px;
}

.feature-content h3 {
  font-size: 18px;
  margin-bottom: 10px;
}

.feature-content p {
  font-size: 14px;
  color: #666;
  margin-bottom: 10px;
}

.feature-price {
  font-weight: bold;
  color: #A40A24; /* Your brand color */
}

/* Empty wishlist */
.empty-wishlist {
  margin-top: 40px;
  font-size: 18px;
  color: #999;
}

{% endstylesheet %}